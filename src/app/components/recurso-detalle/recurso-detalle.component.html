<p-toast></p-toast>
<p-confirmDialog></p-confirmDialog>

<div class="mb-3">
  <a routerLink="/recursos" class="flex align-items-center gap-2 text-color">
    <i class="pi pi-arrow-left"></i>
    Volver a recursos
  </a>
</div>

@if (recurso()) {
  <p-card class="mb-4" [header]="recurso()?.nombre" [subheader]="recurso()?.tipo">
    <p class="mb-3">{{ recurso()?.descripcion || 'Sin descripción' }}</p>
    <p-tag [severity]="recurso()?.activo ? 'success' : 'danger'">
      {{ recurso()?.activo ? 'Activo' : 'Inactivo' }}
    </p-tag>
  </p-card>
}

<div class="grid">
  <div class="col-12 md:col-4">
    <p-card header="Seleccioná una fecha">
      <p-date-picker
        [(ngModel)]="fechaSeleccionada"
        dateFormat="yy-mm-dd"
        [minDate]="hoy"
        (onSelect)="cargarSlots()"
        class="w-full"
      ></p-date-picker>
      <div class="mt-3 flex gap-2">
        <button pButton type="button" label="Buscar slots" icon="pi pi-search" (click)="cargarSlots()"></button>
      </div>
    </p-card>
  </div>
  <div class="col-12 md:col-8">
    <p-card header="Slots disponibles">
      <div *ngIf="slots().length === 0" class="text-500">No hay slots para la fecha seleccionada.</div>
      <div class="flex flex-column gap-2">
        <div
          *ngFor="let slot of slots()"
          class="flex align-items-center justify-content-between border-round surface-ground p-2"
        >
          <div>
            <div class="font-medium">
              {{ slot.inicio | date: 'shortTime' }} - {{ slot.fin | date: 'shortTime' }}
            </div>
            <small class="text-500">Capacidad disponible: {{ slot.capacidad }}</small>
          </div>
          <button pButton type="button" label="Reservar" icon="pi pi-calendar-plus" (click)="confirmarReserva(slot)"></button>
        </div>
      </div>
      <div class="mt-3 flex flex-column gap-2">
        <label for="motivo">Motivo (opcional)</label>
        <textarea id="motivo" pInputTextarea [(ngModel)]="motivo" rows="2"></textarea>
      </div>
    </p-card>
  </div>
</div>
